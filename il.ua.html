<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>Discovery: Ukraine</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* General Body and Scene Styling */
        body {
            /* Using a background image of a sunflower field */
            background-image: linear-gradient(rgba(13, 27, 42, 0.85), rgba(13, 27, 42, 0.85)), url(https://images.unsplash.com/photo-1616852391912-3c25e84f3e6b?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1932&q=80);
            background-size: cover;
            background-position: center;
            color: white;
            font-family: 'Nunito', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
            text-align: center;
        }

        .scene {
            display: none;
            width: 90%;
            max-width: 600px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5); /* Make text more readable on background */
        }

        .scene.active {
            display: block;
            animation: fadeIn 1s forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        h1 {
            font-size: 2.5rem;
        }

        p {
            font-size: 1.2rem;
        }

        /* --- SCENE 1: FLAG CHALLENGE --- */
        .flag-container {
            border: 2px solid white;
            padding: 10px;
            margin: 20px auto;
            display: inline-block;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            width: 330px; /* Using official 3:2 ratio */
            height: 220px;
        }

        .flag-part {
             width: 100%;
             height: 50%;
             background-color: #ccc; /* Default grey color */
             cursor: pointer;
        }
        .flag-top { border-radius: 4px 4px 0 0; }
        .flag-bottom { border-radius: 0 0 4px 4px; }


        .palette { margin-top: 20px; }
        .color-btn {
            width: 50px; height: 50px; border-radius: 50%; border: 3px solid white;
            cursor: pointer; margin: 0 10px; box-shadow: 0 0 5px rgba(0,0,0,0.2);
            transition: transform 0.2s;
        }
        .color-btn:hover { transform: scale(1.1); }
        .color-btn[data-color="#0057b7"] { background-color: #0057b7; } /* Ukrainian Blue */
        .color-btn[data-color="#ffd700"] { background-color: #ffd700; } /* Ukrainian Yellow */

        /* --- SCENE 2: CAPITAL CHALLENGE --- */
        #capital-input {
            font-size: 1.5rem; padding: 10px; border-radius: 8px;
            border: none; text-align: center; margin-top: 20px;
        }

        /* --- SCENE 3: STEPPE REWARD --- */
        .steppe-container {
            position: fixed; top: 0; left: 0; width: 100vw;
            height: 100vh; z-index: -1; overflow: hidden;
        }
        /* Simulating glowing particles floating up, like from a wheat or sunflower field */
        .particle {
            position: absolute;
            bottom: -50px;
            background-color: #ffd700;
            border-radius: 50%;
            opacity: 0;
            animation: floatUp 10s infinite ease-in;
        }
        @keyframes floatUp {
            0% { transform: translateY(0) translateX(0) scale(1); opacity: 0.7; }
            100% { transform: translateY(-100vh) translateX(50px) scale(0.5); opacity: 0; }
        }

        /* --- COMMON UI ELEMENTS --- */
        button {
            font-family: 'Nunito', sans-serif; font-size: 1.2rem; padding: 10px 20px;
            border-radius: 8px; border: none; cursor: pointer; background-color: #58cc02;
            color: white; margin-top: 20px; transition: background-color 0.2s;
        }
        button:hover { background-color: #70e000; }
        .feedback { min-height: 24px; font-weight: bold; margin-top: 15px; font-size: 1.1rem; }
        .feedback.correct { color: #58cc02; }
        .feedback.incorrect { color: #ff4b4b; }
    </style>
</head>
<body>

    <!-- Audio elements for sound design -->
    <audio id="correct-sound" src="https://www.soundjay.com/buttons/sounds/button-3.mp3" preload="auto"></audio>
    <!-- Ukrainian Composer Myroslav Skoryk - Melody -->
    <audio id="reward-music" src="https://upload.wikimedia.org/wikipedia/commons/4/47/Myroslav_Skoryk_-_Melody.ogg" preload="auto"></audio>

    <!-- SCENE 1: The Flag Challenge -->
    <div id="scene-flag" class="scene active">
        <h1>Ласкаво просимо! (Welcome!)</h1>
        <p>Your first task is to build the Ukrainian flag. Select a color, then paint the flag.</p>
        <div class="flag-container">
           <div class="flag-part flag-top"></div>
           <div class="flag-part flag-bottom"></div>
        </div>
        <div class="palette">
            <button class="color-btn" data-color="#0057b7"></button>
            <button class="color-btn" data-color="#ffd700"></button>
        </div>
        <p class="feedback"></p>
        <button id="check-flag-btn">Check Flag</button>
    </div>

    <!-- SCENE 2: The Capital Challenge -->
    <div id="scene-capital" class="scene">
        <h1>Challenge 2: The City on the Dnieper</h1>
        <p>On the banks of the mighty Dnieper River lies Ukraine's capital city. What is its name?</p>
        <input type="text" id="capital-input" placeholder="Type here...">
        <p class="feedback"></p>
        <button id="check-capital-btn">Check Answer</button>
    </div>

    <!-- SCENE 3: The Steppe Reward -->
    <div id="scene-steppe" class="scene">
        <div class="steppe-container">
            <!-- Particles will be generated by JS -->
        </div>
        <h1>Вітаємо! (Congratulations!)</h1>
        <p>You have discovered the heart of Ukraine and felt the spirit of its vast fields.</p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- SOUND ELEMENTS ---
            const correctSound = document.getElementById('correct-sound');
            const rewardMusic = document.getElementById('reward-music');

            // --- GENERAL SCENE SWITCHING LOGIC ---
            const scenes = document.querySelectorAll('.scene');
            let currentScene = 0;

            function switchScene() {
                if (scenes[currentScene]) {
                    scenes[currentScene].classList.remove('active');
                }
                currentScene++;
                if (scenes[currentScene]) {
                    scenes[currentScene].classList.add('active');
                    if(currentScene === scenes.length - 1) {
                        rewardMusic.volume = 0.4;
                        rewardMusic.play();
                        createSteppeEffect();
                    }
                }
            }
            
            // --- SCENE 1: FLAG CHALLENGE ---
            const checkFlagBtn = document.getElementById('check-flag-btn');
            const flagFeedback = document.querySelector('#scene-flag .feedback');
            const flagTop = document.querySelector('.flag-top');
            const flagBottom = document.querySelector('.flag-bottom');
            const colorButtons = document.querySelectorAll('#scene-flag .color-btn');
            let selectedColor = null;

            colorButtons.forEach(button => {
                button.addEventListener('click', () => {
                    selectedColor = button.dataset.color;
                    colorButtons.forEach(btn => btn.style.border = '3px solid white');
                    button.style.border = '3px solid #58cc02';
                });
            });

            function applyColor(element) {
                if (selectedColor) {
                    element.style.backgroundColor = selectedColor;
                } else {
                    flagFeedback.textContent = "Please select a color from the palette first!";
                    flagFeedback.className = 'feedback incorrect';
                }
            }
            
            flagTop.addEventListener('click', () => applyColor(flagTop));
            flagBottom.addEventListener('click', () => applyColor(flagBottom));


            checkFlagBtn.addEventListener('click', () => {
                const getNormalizedColor = (colorStr) => {
                    const ctx = document.createElement('canvas').getContext('2d');
                    ctx.fillStyle = colorStr; return ctx.fillStyle;
                };

                const correctBlue = getNormalizedColor('#0057b7');
                const correctYellow = getNormalizedColor('#ffd700');
                
                const isBlueCorrect = getNormalizedColor(window.getComputedStyle(flagTop).backgroundColor) === correctBlue;
                const isYellowCorrect = getNormalizedColor(window.getComputedStyle(flagBottom).backgroundColor) === correctYellow;

                if (isBlueCorrect && isYellowCorrect) {
                    flagFeedback.textContent = 'Чудово! (Excellent!)';
                    flagFeedback.className = 'feedback correct';
                    correctSound.currentTime = 0; correctSound.play();
                    setTimeout(switchScene, 1500);
                } else {
                    flagFeedback.textContent = 'Not quite right. Remember: blue sky over golden fields.';
                    flagFeedback.className = 'feedback incorrect';
                }
            });

            // --- SCENE 2: CAPITAL CHALLENGE ---
            const checkCapitalBtn = document.getElementById('check-capital-btn');
            const capitalInput = document.getElementById('capital-input');
            const capitalFeedback = document.querySelector('#scene-capital .feedback');

            capitalInput.addEventListener('keyup', (event) => { if (event.key === "Enter") { checkCapitalBtn.click(); }});

            checkCapitalBtn.addEventListener('click', () => {
                const userAnswer = capitalInput.value.trim().toLowerCase();
                if (userAnswer === 'kyiv') {
                    capitalFeedback.textContent = 'Correct! Kyiv is the one.';
                    capitalFeedback.className = 'feedback correct';
                    correctSound.currentTime = 0; correctSound.play();
                    setTimeout(switchScene, 1500);
                } else {
                    capitalFeedback.textContent = "That's not it. The city's name starts with 'K'.";
                    capitalFeedback.className = 'feedback incorrect';
                }
            });

            // --- SCENE 3: STEPPE EFFECT ---
            function createSteppeEffect() {
                const container = document.querySelector('.steppe-container');
                for (let i = 0; i < 50; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    const size = Math.random() * 5 + 2;
                    particle.style.width = `${size}px`;
                    particle.style.height = `${size}px`;
                    particle.style.left = `${Math.random() * 100}vw`;
                    particle.style.animationDelay = `${Math.random() * 10}s`;
                    particle.style.animationDuration = `${Math.random() * 5 + 8}s`;
                    container.appendChild(particle);
                }
            }
        });
    </script>
</body>
</html>